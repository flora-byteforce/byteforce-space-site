<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plaid OAuth Return</title>

  <!-- Same CSP so reCAPTCHA can complete after redirect -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    connect-src https://*.plaid.com https://*.plaid.io https://www.google.com https://www.gstatic.com;
    script-src 'self' 'unsafe-inline' https://*.plaid.com https://www.google.com https://www.gstatic.com;
    frame-src https://*.plaid.com https://www.google.com;
    img-src 'self' data: https://www.google.com https://www.gstatic.com;
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://www.gstatic.com;
  ">
  <script src="https://cdn.plaid.com/link/v2/stable/link-initialize.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; }
  </style>
</head>
<body>
  <p>Resuming bank connectionâ€¦</p>
  <script>
    // Use the exact same token you used on link.html
    const LINK_TOKEN = "link-production-eb548a1e-d5a4-44a7-9c1f-edbc41742720";
    const handler = Plaid.create({ token: LINK_TOKEN });

    // Automatically resume
    handler.open();

    // Optional logging
    handler._options.onEvent = (eventName, metadata) => {
      console.log("Link event (redirect):", eventName, metadata);
    };
    handler._options.onExit = (err, metadata) => {
      console.log("EXIT (redirect) err:", err);
      console.log("EXIT (redirect) metadata:", metadata);
      if (metadata && metadata.link_session_id) {
        console.log("link_session_id:", metadata.link_session_id);
      }
    };
  </script>
</body>
</html>
