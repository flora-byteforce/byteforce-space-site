<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plaid OAuth Return</title>

  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    connect-src https://*.plaid.com https://*.plaid.io https://www.google.com https://www.gstatic.com;
    script-src 'self' 'unsafe-inline' https://*.plaid.com https://www.google.com https://www.gstatic.com;
    frame-src https://*.plaid.com https://www.google.com;
    img-src 'self' data: https://www.google.com https://www.gstatic.com;
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://www.gstatic.com;
  ">
  <script src="https://cdn.plaid.com/link/v2/stable/link-initialize.js"></script>
</head>
<body>
  <p>Resuming bank connectionâ€¦</p>
  <script>
    // Use the exact same link token as on your main page
    const LINK_TOKEN = "link-production-eb548a1e-d5a4-44a7-9c1f-edbc41742720";

    const handler = Plaid.create({
      token: LINK_TOKEN,
      // ðŸ‘‡ This is the key for OAuth resume on web
      receivedRedirectUri: window.location.href
    });

    handler.open();

    // Optional logging
    handler._options.onEvent = (eventName, metadata) => {
      console.log("Link event (redirect):", eventName, metadata);
    };
    handler._options.onExit = (err, metadata) => {
      console.log("EXIT (redirect) err:", err);
      console.log("EXIT (redirect) metadata:", metadata);
    };
  </script>
</body>
</html>
